검색기능 시
post를 검색
1. 태그로 검색 -> match로 tags를 검색 -> 공백기준으로 아예 일치하는것만 찾는듯?
2. 전문으로 검색 -> prefix로 title을 검색 -> 공백기준으로 앞글자부터 매칭되는걸 찾는듯?

태그구현중

1. 유저생성, 프로필 수정 시 엘라스틱에 반영 구현완
2. 업로드 시 타이틀에서 해시태그 부분만 찾아서 태그카운트, 태그와 전문으로 검색위해 엘라스틱에 등록 구현완

더 구현해야할것
3. 댓글과 업로드 타이틀 작성 시 @와 #입력 반응해서 실시간 검색되도록, 
완
4. 글에서 @#들은 <a>태그로 감싸서 리턴하게.
4구현 일부 완료, 해시태그 클릭 시 페이지구현 후 postFooter.tsx로 가서 마무리 하기
지금 해시태그 클릭시 url부분 구현부족 완료

5. 검색 페이지 만들어서 글에서 @, #앞에 붙은 글자들 클릭 시 프로필로 넘어가거나, 해시태그 검색탭으로 넘어가게 해야함
5 할차례, url로 온 string으로 해시태그 검색한 결과창 만들어야함.

23.10.11
완료, 근데 최근 게시물부터 보이게 하려고 createdAt필드를 tags DOC에 추가했고
hashtag.service 에서의 쿼리에서 sort를 썼는데 뭔가 이상하다.
제대로 못불러오는거같음.

titleInput에서 클릭 시 타이틀 수정하는것도 해야함. 완료,


6. 실시간 검색된 결과를 클릭 시 text수정해서 덮어씌우기 

하면 해시태그, 사람태그, 실시간 검색까지 완료인듯? 완료. 23.10.15


몽고랑 엘라스틱 동기화를 구현해놨는데, 정작 사용할일이 잘없다.
db낭비를 줄이기 위해 몽고랑 엘라스틱이랑 저장되는 내용이 다름

hashtag는 post관할,
지금 post랑 metadata랑 경계가 매우 모호하다.. 설게가 잘못된건 아닌거같은데
최초 요청을 metadata로 하는지 post로 하는지 app로 하는지 명확한 기준이 없어서
애매하다.


23.10.11
굉장히 오랜기간 이걸 진행중이다.
지금 느끼는점은, 루즈커플링의 장점은 잘 알겠는데,
내가 설계를 잘못한 탓인지, 너무 루즈하게 하려고 한 탓인지
뭐 하나 수정을하려면 굉장히 많이 찾아가면서 수정을 해야한다...
예를들어 post 한개를 띄우려고 하면, 좋아요 찾아가서 가져와야하고
metadata가서 사진 url 가져와야하고, title이랑 카운트 pgdb가서 가져와야하고
뭐 나름 장단점이 다 있겠는데, 지금 단점만 느끼고 있다.

다르게 생각해보면, 하나에 싹다 몰빵해서 db를 짜본적이 없어서 멀리멀리 분산해서
만드는것의 장점을 못느끼고 있는걸수도 있고..

어쨋든 초반에 생각을 더 해서 db설계를 했어야 했는데 대충 
이렇게하면 잘 굴러가겠지? 하면서 만든걸 후회중이다.

23.10.15
이제 댓글에서도 사람검색해서 태그할수 있게 검색창 띄우기 시작.
23.10.16
완료,
지금 버그가, 검색모달로 실시간검색한 걸 클릭 시 원본
글을 갈아끼우는데, 이게 useState를 사용하다보니까 갈아끼우면서 하는 업데이트가
뭔가 이상하다. 암만 시뮬레이션 돌려봐도 결과는 정확한데
자꾸 이상하게 텍스트가 업데이트됨. state가 이상하다고 밖에 생각안된다.
일단 버그를 인지만 하고 나중에 머리 비우고 구현을 싹다 다시 해봐야할듯.

23.10.17
검색창 구현 시작

해야할일
검색창에서 검색한거 클릭 시 창이동 구현 -완
결과 모두보기 버튼 만들어서 클릭 시 종합검색창으로 이동
종합검색창? 구현

라이브검색 결과 갯수 제한하기

이후 레디스 캐시서버 구현 시작
간단구상
포스트 하나 가져오려면, 여러 서버로 요청보내서 조립해서 클라이언트에 표시하는데,
조립된 결과를 캐시서버에 저장하면, 여러서버로 보내는 요청을 아낄 수 있지 않을까?
라는 생각임. 근데 캐시서버에 있는 결과가 old될 수 있음. 에 대한 방어도 필요

또 검색창에서 보여주는 postlist는 그냥 캐시서버에서 가져오는 포스트들.

23.10.21
모든검색창 탭 계속 구현중,
게시물탭은 완료, 유저탭에서 무한스크롤 구현해야함, 태그탭은 그 다음 구현.
그리고.. 검색 페이지들에서 검색바 클릭하면 실시간 검색해서 가져오는데,
뒤로가기로 실시간검색창 내렸다가 다시키면 또 검색한다.
검색바 껏다킬때 다시검색 안되게 수정하고싶다. -> 완료

무한스크롤(완), 태그탭은 아직안했음 -완료

10.23
검색탭에서 엔터누르면 모두검색 페이지로 넘어가게 만들고 -완
결과 모두 보기 까지 넣기 -완

더 구현해야할것 
게시물삭제, 댓글삭제, 대댓삭제, 게시물 수정(이건 빡셀듯, 글 수정은 쉬운데..
또 수정 탭 만드는것도..) 댓수정
뭐든 삭제 시에, postgres에 들어간거는 cascade삭제가 되는데 몽고에는 안됨
-> 카운터랑 삭제할것들 리스트 만들어서 카운터마다 일괄삭제시키기
(좀 이따가 삭제해도 되는게 있고 바로해야하는게 있고 를 구별해서 적용)

팔로우 관리, 팔로우창에서 사람검색, 좋아요 누른 게시물 모아보기
정도하면 거의 끝 아닌가?

다하고 나면 알림기능 구현, 레디스서버 구현

추가 - 버그있음, 랜딩코멘트에서 더 불러오기가 항상뜬다, 피드의 comment에서는 안뜬다.
그리고 로그아웃 구현까지

ㅋㅋㅋ진짜 프런트코드는 답도없다 ㅋㅋㅋㅋㅋㅋㅋㅋ 보기만해도 숨이 턱턱막힌다

10.24
삭제기능 구현중이다.
post comment cocomment가 casacde 등록돼있는데 이거 풀어야할듯?
뭐 하나가 없어지기라도하면 싹다 삭제작업 해야하는데
리소스 많이먹을거같다. cascade 안해도 될듯? 댓글 기록용으로도 필요할듯 하고,
만약 누가 태그해서 알림떴으면 게시글없어졌다고 알림을 없애는것도 힘들고.

그냥 삭제관리 객체 만들어서 관리시키게 해야할듯 cascade는 안하는게 맞는듯.
ㅋㅋㅋㅋ 근데 이렇게 하면 애초에 postgres쓴 이유가 cascade삭제 편리함 떄문인데...
허허

게시물삭제 중 post서버에서 할일은 끝,
유저에서 구현중

10.29

삭제기능 프런트 백 모두 구현완료, 댓글창 버그픽스까지 했음.
글, 댓글 수정은 나중에하자...
1. 좋아요 누른 게시물 모아보기를 만들어서 userinfomenu에 넣기,
2. 팔로우 관리 창 만들기
2-2. 팔로잉 팔로워 보는 모달에서 검색기능 추가

추후 캐시서버 알림서버

아 팔로워 팔로잉에서 username으로 검색하게 할 수가 없다.
팔로우 팔로잉 저장이 id로 저장되기 때문...
좀 복잡하긴 한데... username을 검색날리면 username으로 userId찾아서 어쩌구저쩌구
는 안됨. 안된다.

방법2 팔로우 팔로잉 doc에 username필드를 추가 -> username업데이트 시에는?