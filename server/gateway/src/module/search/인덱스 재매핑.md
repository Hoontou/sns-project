아니근데 왜자꾸 '/'뒤에 '\'역슬래시가 붙는거지?
url에서 \ 역슬래시는 지우고 날리길.

GET sns.posts

result

{
"sns.posts" : {
"aliases" : { },
"mappings" : {
"properties" : {
"createdAt" : {
"type" : "date"
},
"tags" : {
"type" : "text"
},
"title" : {
"type" : "text"
}
}
},
"settings" : {
"index" : {
"number_of_shards" : "5",
"provided_name" : "sns.posts",
"creation_date" : "1713172097872",
"analysis" : {
"analyzer" : {
"my_analyzer" : {
"type" : "custom",
"tokenizer" : "seunjeon_tokenizer"
}
}
},
"number_of_replicas" : "1",
"uuid" : "AkIfuTgmSvCD6Jgx0fk0lw",
"version" : {
"created" : "7100299"
}
}
}
}
}
이것이 기본 매핑이었고,

PUT /sns.posts.new
{
"settings": {
"number_of_shards": 5,
"number_of_replicas": 1,
"analysis": {
"analyzer": {
"my_analyzer": {
"type": "custom",
"tokenizer": "seunjeon_tokenizer"
}
}
}
},
"mappings": {
"properties": {
"createdAt": {
"type": "date"
},
"tags": {
"type": "text"
},
"title": {
"type": "text",
"analyzer": "my_analyzer"
}
}
}
}
이렇게 해서 title에만 제대로된 한국어 분석을 위해 은전한닢 토크나이저 적용해서 만든다.

POST /\_reindex
{
"source": {
"index": "sns.posts"
},
"dest": {
"index": "sns.posts.new"
}
}

그후 new인덱스에 기존의 인덱스정보를 가져옴

GET /sns.posts.new/\_search
{
"size": 100,
"query": {
"match_all": {}
}
}
제대로 됐는지 보기위해 기존 문서중에 적당한거 id 가져와서

POST /sns.posts.new/\_termvectors/661df65bc30d6b1daeb34aa2(id)
{
"fields": ["title"],
"offsets": false,
"positions": false,
"term_statistics": true,
"field_statistics": true
}
와 같이 날려주면 분석된 토큰 나옴.

DELETE sns.posts
로 기존 인덱스 날려주고

PUT /sns.posts
{
"settings": {
"number_of_shards": 5,
"number_of_replicas": 1,
"analysis": {
"analyzer": {
"my_analyzer": {
"type": "custom",
"tokenizer": "seunjeon_tokenizer"
}
}
}
},
"mappings": {
"properties": {
"createdAt": {
"type": "date"
},
"tags": {
"type": "text"
},
"title": {
"type": "text",
"analyzer": "my_analyzer"
}
}
}
}
이렇게 아까 new만들때 썼던 인덱스설정 그대로 해서 다시 만든 후

POST /\_reindex
{
"source": {
"index": "sns.posts.new"
},
"dest": {
"index": "sns.posts"
}
}이번엔 posts.new거를 posts에 넣어주면 끝.

마찬가지로 match_all쿼리로 가져와서
\_termvectors 로 확인하면 됨.

제대로 옮겨졌다면 new도 삭제.

아니근데 왜자꾸 '/'뒤에 '\'역슬래시가 붙는거지?
url에서 \ 역슬래시는 지우고 날리길.
